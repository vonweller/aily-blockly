# 文件操作工具重构说明

## 概述

原来的 `file_operations` 工具过于笼统，经常导致使用错误。现在已将其拆分为多个专门的文件操作工具，每个工具专注于单一功能，提供更清晰的接口和更好的错误处理。

## 新工具列表

### 1. list_directory - 列出目录内容
- **功能**: 列出指定目录的所有文件和文件夹
- **参数**: 
  - `path`: 目录路径
- **返回**: JSON格式的文件列表，包含名称、类型、大小、修改时间

### 2. read_file - 读取文件
- **功能**: 读取文件内容
- **参数**: 
  - `path`: 文件路径
  - `encoding`: 编码格式 (可选，默认 utf-8)
- **返回**: 文件内容文本

### 3. create_file - 创建文件
- **功能**: 创建新文件并写入内容
- **参数**: 
  - `path`: 文件路径
  - `content`: 文件内容 (可选，默认空)
  - `encoding`: 编码格式 (可选，默认 utf-8)
  - `overwrite`: 是否覆盖已存在文件 (可选，默认 false)
- **特性**: 自动创建目录，支持覆盖保护

### 4. create_folder - 创建文件夹
- **功能**: 创建新文件夹
- **参数**: 
  - `path`: 文件夹路径
  - `recursive`: 是否递归创建 (可选，默认 true)
- **特性**: 支持多级目录创建

### 5. edit_file - 编辑文件
- **功能**: 修改已存在文件的内容
- **参数**: 
  - `path`: 文件路径
  - `content`: 新内容
  - `encoding`: 编码格式 (可选，默认 utf-8)
  - `createIfNotExists`: 文件不存在时是否创建 (可选，默认 false)
- **特性**: 可选的创建新文件功能

### 6. delete_file - 删除文件
- **功能**: 删除指定文件
- **参数**: 
  - `path`: 文件路径
  - `createBackup`: 是否创建备份 (可选，默认 true)
- **特性**: 自动备份功能，以 ZBAK_ 前缀命名

### 7. delete_folder - 删除文件夹
- **功能**: 删除文件夹及其内容
- **参数**: 
  - `path`: 文件夹路径
  - `createBackup`: 是否创建备份 (可选，默认 true)
  - `recursive`: 是否递归删除 (可选，默认 true)
- **特性**: 递归删除，自动备份功能

### 8. check_exists - 检查存在性
- **功能**: 检查文件或文件夹是否存在
- **参数**: 
  - `path`: 路径
  - `type`: 期望类型 - file/folder/any (可选，默认 any)
- **返回**: JSON格式信息，包含存在性、类型、大小、时间等

### 9. get_directory_tree - 获取目录树
- **功能**: 获取目录的树状结构
- **参数**: 
  - `path`: 目录路径
  - `maxDepth`: 最大深度 (可选，默认 3)
  - `includeFiles`: 是否包含文件 (可选，默认 true)
- **返回**: JSON格式的树状结构
- **特性**: 深度控制，可选只显示文件夹

## 优势

1. **明确的职责**: 每个工具只负责一种操作，减少混淆
2. **更好的错误处理**: 针对特定操作的错误信息更准确
3. **类型安全**: 每个工具有明确的参数定义
4. **更好的用户体验**: AI可以更准确地选择合适的工具
5. **易于维护**: 单一职责便于代码维护和测试

## 迁移指南

### 原来的调用方式:
```typescript
fileOperationsTool({
  operation: 'read',
  path: '/path/to',
  name: 'file.txt'
})
```

### 现在的调用方式:
```typescript
readFileTool({
  path: '/path/to/file.txt'
})
```

### 主要变化:
1. 移除了 `operation` 参数
2. 路径处理更简单，直接使用完整路径
3. 每个工具有专门的参数集合
4. 更清晰的返回值结构

## 备注

- 所有工具都保留了原有的路径规范化功能
- 保持了 Windows 和 Unix 路径的兼容性
- 保留了备份功能，提高安全性
- 新增了更多的配置选项，提供更大的灵活性
