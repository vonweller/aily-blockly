@if (currentUrl == "/serial-monitor") {
<app-sub-window [title]="windowInfo" [winBtns]="['go-main', 'minimize', 'maximize', 'close']">
  <ng-container *ngTemplateOutlet="windowBoxTemplate"></ng-container>
</app-sub-window>
} @else {
<app-tool-container [title]="windowInfo" [path]="'/serial-monitor'" (closeEvent)="close()">
  <ng-container *ngTemplateOutlet="windowBoxTemplate"></ng-container>
</app-tool-container>
}
<ng-template #windowBoxTemplate>
  <div class="window-box">
    <!-- <div class="left-bar">
      <div
        class="btn ccenter selected"
        nz-tooltip
        nzTooltipTitle="基础设置"
        nzTooltipPlacement="left"
      >
        <i class="fa-light fa-gear"></i>
      </div>
      <div
        class="btn ccenter"
        nz-tooltip
        nzTooltipTitle="图表显示"
        nzTooltipPlacement="left"
      >
        <i class="fa-light fa-chart-line"></i>
      </div>
      <div
        class="btn ccenter"
        nz-tooltip
        nzTooltipTitle="调试辅助"
        nzTooltipPlacement="left"
      >
        <i class="fa-light fa-bug"></i>
      </div>
      <div
        class="btn ccenter"
        nz-tooltip
        nzTooltipTitle="自动化"
        nzTooltipPlacement="left"
      >
        <i class="fa-light fa-code-branch"></i>
      </div>
      <div
        class="btn ccenter"
        nz-tooltip
        nzTooltipTitle="高亮设置"
        nzTooltipPlacement="left"
      >
        <i class="fa-light fa-paint-roller"></i>
      </div>
    </div> -->
    <div class="main-box">
      <div class="settings">
        <div class="line">
          <div class="item">
            <div class="text">串口</div>
            <div class="item-inner ccenter" (click)="openPortList($event)">
              <div>{{currentPort}}</div>
              <div class="arrow-box">
                <i class="fa-light fa-angle-right arrow" [ngClass]="{'down':showPortList}"></i>
              </div>
            </div>
          </div>
          <div class="item">
            <div class="text">波特率</div>
            <div class="item-inner ccenter" (click)="openBaudList($event)">
              <div>{{currentBaudRate}}</div>
              <div class="arrow-box">
                <i class="fa-light fa-angle-right arrow" [ngClass]="{'down':showBaudList}"></i>
              </div>
            </div>
          </div>
          <div class="switch">
            <nz-switch [(ngModel)]="switchValue" (ngModelChange)="switchPort()"></nz-switch>
          </div>
        </div>
      </div>
      <div class="monitor">
        <div class="r-box">
          <ngx-simplebar [options]="options">
            @for (item of dataList; track $index) {
            <app-data-item [data]="item"></app-data-item>
            }
            <div style="height: 10px;"></div>
          </ngx-simplebar>
        </div>
        <div class="btns">
          <div class="btn ccenter hex" nz-tooltip nzTooltipTitle="HEX显示" (click)="changeViewMode('showHex')"
            [ngClass]="{'actived':showHex}">
            <i class="fa-thin fa-rectangle"></i>
            <div>Hex</div>
          </div>
          <div class="btn ccenter" nz-tooltip nzTooltipTitle="自动换行" (click)="changeViewMode('autoWrap')"
            [ngClass]="{'actived':autoWrap}">
            <i class="fa-light fa-arrow-turn-down-left"></i>
          </div>
          <div class="btn ccenter" nz-tooltip nzTooltipTitle="自动滚动" (click)="changeViewMode('autoScroll')"
            [ngClass]="{'actived':autoScroll}">
            <i class="fa-light fa-arrow-down-to-line"></i>
          </div>
          <div class="btn ccenter" nz-tooltip nzTooltipTitle="时间戳" (click)="changeViewMode('showTimestamp')"
            [ngClass]="{'actived':showTimestamp}">
            <i class="fa-light fa-timer"></i>
          </div>
          <div class="btn ccenter" nz-tooltip nzTooltipTitle="显示不可见字符" (click)="changeViewMode('showCtrlChar')"
            [ngClass]="{'actived':showCtrlChar}">
            <i class="fa-light fa-eye"></i>
          </div>
          <!-- <div class="btn ccenter right3" nz-tooltip nzTooltipTitle="搜索">
            <i class="fa-light fa-magnifying-glass"></i>
          </div> -->
          <div class="btn ccenter right2" nz-tooltip nzTooltipTitle="导出" (click)="exportData()">
            <i class="fa-light fa-download"></i>
          </div>
          <div class="btn ccenter right" nz-tooltip nzTooltipTitle="清除" (click)="clearView()">
            <i class="fa-light fa-trash-can"></i>
          </div>
        </div>
      </div>
      <div class="sender" nz-resizable [style.height.px]="bottomHeight" [nzMaxHeight]="500" [nzMinHeight]="180"
        (nzResize)="onContentResize($event)">
        <nz-resize-handle nzDirection="top">
          <div class="line"></div>
        </nz-resize-handle>
        <div class="s-box">
          <textarea class="sscroll vsfont" nz-input [(ngModel)]="inputValue"></textarea>
          <div class="btns">
            <div class="btn ccenter hex" nz-tooltip nzTooltipTitle="HEX显示">
              <i class="fa-thin fa-rectangle"></i>
              <div>Hex</div>
            </div>
            <div class="btn ccenter enter" nz-tooltip nzTooltipTitle="回车发送">
              <i class="fa-light fa-arrow-turn-down-left"></i>
            </div>
            <!-- <div class="btn ccenter right" nz-tooltip nzTooltipTitle="发送文件">
              <i class="fa-light fa-file-export"></i>
            </div> -->
            <button nz-button nzType="primary" (click)="send()">发送</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<!-- device port list -->
@if (showPortList) {
<app-menu [position]="position" [width]="260" [menuList]="portList" (closeEvent)="closePortList()"
  [keywords]="boardKeywords" (itemClickEvent)="selectPort($event)"></app-menu>
}

<!-- baudrate list -->
@if (showBaudList) {
<app-menu [position]="position" [width]="100" [menuList]="baudList" (closeEvent)="closeBaudList()"
  (itemClickEvent)="selectBaud($event)"></app-menu>
}